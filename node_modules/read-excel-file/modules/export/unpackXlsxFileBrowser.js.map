{"version":3,"file":"unpackXlsxFileBrowser.js","names":["unzipFromArrayBuffer","convertValuesFromUint8ArraysToStrings","filterZipArchiveEntry","unpackXlsxFile","input","File","Blob","arrayBuffer","then","getResultFromArrayBuffer","Promise","resolve","filter"],"sources":["../../source/export/unpackXlsxFileBrowser.js"],"sourcesContent":["// Uses an \"async\" function of the unzipper function\r\n// just because it feels more correct to use it over the \"sync\" one\r\n// because it isn't supposed to ever freeze the \"main thread\" (GUI).\r\n//\r\n// import unzipFromArrayBufferSync from '../zip/unzipFromArrayBufferSync.js'\r\nimport unzipFromArrayBuffer from '../zip/unzipFromArrayBuffer.js'\r\n\r\nimport convertValuesFromUint8ArraysToStrings from './convertValuesFromUint8ArraysToStrings.js'\r\nimport filterZipArchiveEntry from './filterZipArchiveEntry.js'\r\n/**\r\n * Unpacks `*.xlsx` file contents, because it's just a `*.zip` archive.\r\n * @param  {(File|Blob|ArrayBuffer)} input\r\n * @return {Promise<Record<string,string>} Resolves to an object holding `*.xlsx` file entries.\r\n */\r\nexport default function unpackXlsxFile(input) {\r\n\tif (input instanceof File || input instanceof Blob) {\r\n\t\treturn input.arrayBuffer().then(getResultFromArrayBuffer)\r\n\t}\r\n\treturn Promise.resolve(input).then(getResultFromArrayBuffer)\r\n}\r\n\r\nfunction getResultFromArrayBuffer(arrayBuffer) {\r\n\treturn unzipFromArrayBuffer(arrayBuffer, { filter: filterZipArchiveEntry }).then(\r\n\t\tconvertValuesFromUint8ArraysToStrings\r\n\t)\r\n}\r\n\r\n// function getResultFromArrayBufferSync(arrayBuffer) {\r\n//  const result = unzipFromArrayBufferSync(arrayBuffer, { filter: filterZipArchiveEntry })\r\n// \treturn convertValuesFromUint8ArraysToStrings(result)\r\n// }"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA,OAAOA,oBAAoB,MAAM,gCAAgC;AAEjE,OAAOC,qCAAqC,MAAM,4CAA4C;AAC9F,OAAOC,qBAAqB,MAAM,4BAA4B;AAC9D;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,cAAcA,CAACC,KAAK,EAAE;EAC7C,IAAIA,KAAK,YAAYC,IAAI,IAAID,KAAK,YAAYE,IAAI,EAAE;IACnD,OAAOF,KAAK,CAACG,WAAW,CAAC,CAAC,CAACC,IAAI,CAACC,wBAAwB,CAAC;EAC1D;EACA,OAAOC,OAAO,CAACC,OAAO,CAACP,KAAK,CAAC,CAACI,IAAI,CAACC,wBAAwB,CAAC;AAC7D;AAEA,SAASA,wBAAwBA,CAACF,WAAW,EAAE;EAC9C,OAAOP,oBAAoB,CAACO,WAAW,EAAE;IAAEK,MAAM,EAAEV;EAAsB,CAAC,CAAC,CAACM,IAAI,CAC/EP,qCACD,CAAC;AACF;;AAEA;AACA;AACA;AACA"}