{"version":3,"file":"parseXlsxFileContentsWithOptionalSchema.js","names":["parseXlsxFileContents","mapToObjects","parseXlsxFileContentsWithOptionalSchema","contents","xml","_ref","schema","options","_objectWithoutProperties","_excluded","map","Error","result","_objectSpread","properties","data"],"sources":["../../source/xlsx/parseXlsxFileContentsWithOptionalSchema.js"],"sourcesContent":["import parseXlsxFileContents from './parseXlsxFileContents.js'\r\n\r\nimport mapToObjects from './schema/mapToObjects.js'\r\n\r\n/**\r\n * Reads data from an `.xlsx` spreadsheet.\r\n * @param {Record<string,string>} contents — A map of XML files inside XLSX file (which is just a zipped directory).\r\n * @param {object} xml — An object with a function `createDocument(string)`.\r\n * @param {object} options\r\n * @returns Spreadsheet data\r\n */\r\nexport default function parseXlsxFileContentsWithOptionalSchema(contents, xml, { schema, ...options }) {\r\n\tif (options.map) {\r\n\t\tthrow new Error('`map` option was removed. Pass a `schema` option instead.')\r\n\t}\r\n\t// `parseXlsxFileContents()` function creates `options.rowIndexSourceMap` property.\r\n\t// It maps parsed data row indexes to spreadsheet row indexes.\r\n\t// That's because empty rows are ignored (discarded) when parsing using `schema`.\r\n\tconst result = parseXlsxFileContents(contents, xml, {\r\n\t\t...options,\r\n\t\tproperties: schema || options.properties\r\n\t})\r\n\tif (schema) {\r\n\t\treturn mapToObjects(result.data, schema, {\r\n\t\t\t...options,\r\n\t\t\tproperties: result.properties\r\n\t\t})\r\n\t}\r\n\treturn result\r\n}"],"mappings":";;;;;;;;;AAAA,OAAOA,qBAAqB,MAAM,4BAA4B;AAE9D,OAAOC,YAAY,MAAM,0BAA0B;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,uCAAuCA,CAACC,QAAQ,EAAEC,GAAG,EAAAC,IAAA,EAA0B;EAAA,IAAtBC,MAAM,GAAAD,IAAA,CAANC,MAAM;IAAKC,OAAO,GAAAC,wBAAA,CAAAH,IAAA,EAAAI,SAAA;EAClG,IAAIF,OAAO,CAACG,GAAG,EAAE;IAChB,MAAM,IAAIC,KAAK,CAAC,2DAA2D,CAAC;EAC7E;EACA;EACA;EACA;EACA,IAAMC,MAAM,GAAGZ,qBAAqB,CAACG,QAAQ,EAAEC,GAAG,EAAAS,aAAA,CAAAA,aAAA,KAC9CN,OAAO;IACVO,UAAU,EAAER,MAAM,IAAIC,OAAO,CAACO;EAAU,EACxC,CAAC;EACF,IAAIR,MAAM,EAAE;IACX,OAAOL,YAAY,CAACW,MAAM,CAACG,IAAI,EAAET,MAAM,EAAAO,aAAA,CAAAA,aAAA,KACnCN,OAAO;MACVO,UAAU,EAAEF,MAAM,CAACE;IAAU,EAC7B,CAAC;EACH;EACA,OAAOF,MAAM;AACd"}