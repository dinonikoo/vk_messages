"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = unpackXlsxFile;
var _unzipFromArrayBuffer = _interopRequireDefault(require("../zip/unzipFromArrayBuffer.js"));
var _convertValuesFromUint8ArraysToStrings = _interopRequireDefault(require("./convertValuesFromUint8ArraysToStrings.js"));
var _filterZipArchiveEntry = _interopRequireDefault(require("./filterZipArchiveEntry.js"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }
/**
 * Unpacks `*.xlsx` file contents, because it's just a `*.zip` archive.
 * @param  {Blob} input
 * @return {Promise<Record<string,string>} Resolves to an object holding `*.xlsx` file entries.
 */
function unpackXlsxFile(input) {
  return input.arrayBuffer().then(function (arrayBuffer) {
    return (0, _unzipFromArrayBuffer["default"])(arrayBuffer, {
      filter: _filterZipArchiveEntry["default"]
    });
  }).then(_convertValuesFromUint8ArraysToStrings["default"]);
}
//# sourceMappingURL=unpackXlsxFileUniversal.js.map