{"version":3,"file":"convertInputToNodeStream.js","names":["_fs","_interopRequireDefault","require","_buffer","_stream","_interopRequireWildcard","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","convertInputToNodeStream","input","Stream","Buffer","createReadableStreamFromBuffer","Blob","createReadableStreamFromBlob","fs","createReadStream","buffer","length","Error","Readable","from","blob","size","fromWeb","stream"],"sources":["../../source/export/convertInputToNodeStream.js"],"sourcesContent":["import fs from 'fs'\r\nimport { Blob } from 'buffer'\r\nimport Stream, { Readable } from 'stream'\r\n\r\n/**\r\n * Converts Node.js input argument to a stream.\r\n * @param  {(string|Stream|Buffer|Blob)} input - A Node.js readable stream or a `Buffer` or a `Blob` or a path to a file.\r\n * @returns {Stream}\r\n */\r\nexport default function convertInputToNodeStream(input) {\r\n  return input instanceof Stream\r\n    ? input\r\n    : (\r\n      input instanceof Buffer\r\n        ? createReadableStreamFromBuffer(input)\r\n        : (\r\n          input instanceof Blob\r\n            ? createReadableStreamFromBlob(input)\r\n            : fs.createReadStream(input)\r\n        )\r\n    )\r\n}\r\n\r\n// Creates a readable stream from a `Buffer`.\r\nfunction createReadableStreamFromBuffer(buffer) {\r\n  // Node.js seems to have a bug in `Readable.from()` function:\r\n  // it doesn't correctly handle empty buffers, i.e. it doesn't return a correct stream.\r\n  // https://gitlab.com/catamphetamine/read-excel-file/-/issues/106\r\n  if (buffer.length === 0) {\r\n    throw new Error('No data')\r\n  }\r\n  return Readable.from(buffer)\r\n}\r\n\r\n// Creates a readable stream from a `Blob`.\r\nfunction createReadableStreamFromBlob(blob) {\r\n  // I didn't test but I'd presume that Node.js would throw on an empty `Blob`\r\n  // same way it does on an empty `Buffer`.\r\n  // https://gitlab.com/catamphetamine/read-excel-file/-/issues/106\r\n  if (blob.size === 0) {\r\n    throw new Error('No data')\r\n  }\r\n  // Convert a web `ReadableStream` to a Node.js `Readable` `Stream`.\r\n  return Readable.fromWeb(blob.stream())\r\n}"],"mappings":";;;;;;;AAAA,IAAAA,GAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAC,uBAAA,CAAAH,OAAA;AAAyC,SAAAI,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,yBAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAF,wBAAAM,GAAA,EAAAJ,WAAA,SAAAA,WAAA,IAAAI,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,aAAAE,OAAA,CAAAF,GAAA,yBAAAA,GAAA,uCAAAA,GAAA,UAAAG,KAAA,GAAAR,wBAAA,CAAAC,WAAA,OAAAO,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAJ,GAAA,YAAAG,KAAA,CAAAE,GAAA,CAAAL,GAAA,SAAAM,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAX,GAAA,QAAAW,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAd,GAAA,EAAAW,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAV,GAAA,EAAAW,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAX,GAAA,CAAAW,GAAA,SAAAL,MAAA,cAAAN,GAAA,MAAAG,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAAhB,GAAA,EAAAM,MAAA,YAAAA,MAAA;AAAA,SAAAhB,uBAAAU,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,gBAAAA,GAAA;AAEzC;AACA;AACA;AACA;AACA;AACe,SAASiB,wBAAwBA,CAACC,KAAK,EAAE;EACtD,OAAOA,KAAK,YAAYC,kBAAM,GAC1BD,KAAK,GAELA,KAAK,YAAYE,MAAM,GACnBC,8BAA8B,CAACH,KAAK,CAAC,GAErCA,KAAK,YAAYI,YAAI,GACjBC,4BAA4B,CAACL,KAAK,CAAC,GACnCM,cAAE,CAACC,gBAAgB,CAACP,KAAK,CAElC;AACL;;AAEA;AACA,SAASG,8BAA8BA,CAACK,MAAM,EAAE;EAC9C;EACA;EACA;EACA,IAAIA,MAAM,CAACC,MAAM,KAAK,CAAC,EAAE;IACvB,MAAM,IAAIC,KAAK,CAAC,SAAS,CAAC;EAC5B;EACA,OAAOC,gBAAQ,CAACC,IAAI,CAACJ,MAAM,CAAC;AAC9B;;AAEA;AACA,SAASH,4BAA4BA,CAACQ,IAAI,EAAE;EAC1C;EACA;EACA;EACA,IAAIA,IAAI,CAACC,IAAI,KAAK,CAAC,EAAE;IACnB,MAAM,IAAIJ,KAAK,CAAC,SAAS,CAAC;EAC5B;EACA;EACA,OAAOC,gBAAQ,CAACI,OAAO,CAACF,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC;AACxC"}