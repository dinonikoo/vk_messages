"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = unpackXlsxFile;
var _unzipFromStream = _interopRequireDefault(require("../zip/unzipFromStream.js"));
var _convertInputToNodeStream = _interopRequireDefault(require("./convertInputToNodeStream.js"));
var _convertValuesFromUint8ArraysToStrings = _interopRequireDefault(require("./convertValuesFromUint8ArraysToStrings.js"));
var _filterZipArchiveEntry = _interopRequireDefault(require("./filterZipArchiveEntry.js"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }
/**
 * Unpacks XLSX file contents, because it's just a `*.zip` archive.
 * @param  {(string|Stream|Buffer|Blob)} input - A Node.js readable stream or a `Buffer` or a `Blob` or a path to a file.
 * @return {Promise} Resolves to an object holding XLSX file entries.
 */
function unpackXlsxFile(input) {
  var stream = (0, _convertInputToNodeStream["default"])(input);
  return (0, _unzipFromStream["default"])(stream, {
    filter: _filterZipArchiveEntry["default"]
  }).then(_convertValuesFromUint8ArraysToStrings["default"]);
}
//# sourceMappingURL=unpackXlsxFileNode.js.map