{"version":3,"file":"xlsx.js","names":["_dom","require","getCells","document","worksheet","documentElement","sheetData","findChild","cells","forEach","row","cell","push","getMergedCells","mergedCells","mergedCellsInfo","mergedCell","getAttribute","getCellValue","node","getCellInlineStringValue","firstElementChild","getFirstElementChild","getTagName","firstElementChildFirstElementChild","textContent","getDimensions","dimensions","getBaseStyles","styleSheet","cellStyleXfs","findChildren","getCellStyles","cellXfs","getNumberFormats","numberFormats","numFmts","getSharedStrings","sst","map","string","t","value","r","getWorkbookProperties","workbook","getRelationships","relationships","getSheets","sheets"],"sources":["../../source/xml/xlsx.js"],"sourcesContent":["import { findChild, findChildren, forEach, map, getFirstElementChild, getTagName } from './dom.js'\r\n\r\n// Returns an array of cells,\r\n// each element being an XML DOM element representing a cell.\r\nexport function getCells(document) {\r\n  const worksheet = document.documentElement\r\n  const sheetData = findChild(worksheet, 'sheetData')\r\n\r\n  const cells = []\r\n  forEach(sheetData, 'row', (row) => {\r\n    forEach(row, 'c', (cell) => {\r\n      cells.push(cell)\r\n    })\r\n  })\r\n  return cells\r\n}\r\n\r\nexport function getMergedCells(document) {\r\n  const worksheet = document.documentElement\r\n  const mergedCells = findChild(worksheet, 'mergeCells')\r\n  const mergedCellsInfo = []\r\n  if (mergedCells) {\r\n    forEach(mergedCells, 'mergeCell', (mergedCell) => {\r\n      mergedCellsInfo.push(mergedCell.getAttribute('ref'))\r\n    })\r\n  }\r\n  return mergedCellsInfo\r\n}\r\n\r\nexport function getCellValue(document, node) {\r\n  return findChild(node, 'v')\r\n}\r\n\r\nexport function getCellInlineStringValue(document, node) {\r\n  // It seems as if in some weirdly-output \"*.xlsx\" files\r\n  // there're non-element nodes of some weird nature.\r\n  // https://gitlab.com/catamphetamine/read-excel-file/-/issues/109\r\n  // This code filters out such weird non-element nodes.\r\n  const firstElementChild = getFirstElementChild(node)\r\n  if (firstElementChild && getTagName(firstElementChild) === 'is') {\r\n    const firstElementChildFirstElementChild = getFirstElementChild(firstElementChild)\r\n    if (firstElementChildFirstElementChild && getTagName(firstElementChildFirstElementChild) === 't') {\r\n      return firstElementChildFirstElementChild.textContent\r\n    }\r\n  }\r\n}\r\n\r\nexport function getDimensions(document) {\r\n  const worksheet = document.documentElement\r\n  const dimensions = findChild(worksheet, 'dimension')\r\n  if (dimensions) {\r\n    return dimensions.getAttribute('ref')\r\n  }\r\n}\r\n\r\nexport function getBaseStyles(document) {\r\n  const styleSheet = document.documentElement\r\n  const cellStyleXfs = findChild(styleSheet, 'cellStyleXfs')\r\n  if (cellStyleXfs) {\r\n    return findChildren(cellStyleXfs, 'xf')\r\n  }\r\n  return []\r\n}\r\n\r\nexport function getCellStyles(document) {\r\n  const styleSheet = document.documentElement\r\n  const cellXfs = findChild(styleSheet, 'cellXfs')\r\n  if (!cellXfs) {\r\n    return []\r\n  }\r\n  return findChildren(cellXfs, 'xf')\r\n}\r\n\r\nexport function getNumberFormats(document) {\r\n  const styleSheet = document.documentElement\r\n  let numberFormats = []\r\n  const numFmts = findChild(styleSheet, 'numFmts')\r\n  if (numFmts) {\r\n    return findChildren(numFmts, 'numFmt')\r\n  }\r\n  return []\r\n}\r\n\r\nexport function getSharedStrings(document) {\r\n\t// An `<si/>` element can contain a `<t/>` (simplest case) or a set of `<r/>` (\"rich formatting\") elements having `<t/>`.\r\n\t// https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.sharedstringitem?redirectedfrom=MSDN&view=openxml-2.8.1\r\n\t// http://www.datypic.com/sc/ooxml/e-ssml_si-1.html\r\n\r\n  const sst = document.documentElement\r\n  return map(sst, 'si', string => {\r\n    const t = findChild(string, 't')\r\n    if (t) {\r\n      return t.textContent\r\n    }\r\n    let value = ''\r\n    forEach(string, 'r', (r) => {\r\n      value += findChild(r, 't').textContent\r\n    })\r\n    return value\r\n  })\r\n}\r\n\r\nexport function getWorkbookProperties(document) {\r\n  const workbook = document.documentElement\r\n  return findChild(workbook, 'workbookPr')\r\n}\r\n\r\nexport function getRelationships(document) {\r\n  const relationships = document.documentElement\r\n  return findChildren(relationships, 'Relationship')\r\n}\r\n\r\nexport function getSheets(document) {\r\n  const workbook = document.documentElement\r\n  const sheets = findChild(workbook, 'sheets')\r\n  return findChildren(sheets, 'sheet')\r\n}"],"mappings":"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"}